CREATE DATABASE JYoplac
GO

USE JYoplac
GO

CREATE TABLE Alumno(
IdAlu CHAR(4) PRIMARY KEY,
ApeAlu VARCHAR(25) NOT NULL,
NomAlu VARCHAR(25) NOT NULL,
DirAlu VARCHAR(30) NOT NULL
)
GO

CREATE TABLE Curso(
IdCur CHAR(3) PRIMARY KEY,
NomCur VARCHAR(25) NOT NULL,
Costo NUMERIC(8,2) NOT NULL
)
GO

CREATE TABLE Matricula(
NumMatri CHAR(8) PRIMARY KEY,
FecMatri DATE NOT NULL,
IdAlu CHAR(4) REFERENCES ALUMNO,
IdCur CHAR(3) REFERENCES CURSO
)
GO

CREATE PROC USP_BUSCAR_NOMBRE_CURSO
@Nombre VARCHAR(25)
AS
	SELECT * FROM Curso WHERE NomCur LIKE RTRIM(@Nombre) + '%' ORDER BY NomCur
GO

CREATE PROC USP_BUSCAR_RANGOFECHAS_MATRICULA
@Ini DATE, @Fin DATE
AS
	SELECT A.NomAlu, A.ApeAlu, M.FecMatri, C.NomCur, C.Costo FROM Matricula M 
	JOIN Curso C ON M.IdCur = C.IdCur
	JOIN Alumno A ON M.IdAlu = A.IdAlu
	WHERE FecMatri BETWEEN @Ini AND @Fin ORDER BY FecMatri
GO

INSERT INTO Alumno VALUES ('A001', 'YOPLAC', 'JOAQUIN', 'SAN JUAN DE LURIGANCHO')
INSERT INTO Alumno VALUES ('A002', 'NAVARRO', 'SEBASTIAN', 'SAN JUAN DE MIRAFLORES')
INSERT INTO Alumno VALUES ('A003', 'ACOSTA', 'MANUEL', 'PUEBLO LIBRE')
INSERT INTO Alumno VALUES ('A004', 'TORRES', 'NANCY', 'MARIA MAGDALENA')
INSERT INTO Alumno VALUES ('A005', 'COYLLUR', 'CUSI', 'LA MOLINA')

INSERT INTO Curso VALUES ('C01', 'MATEMATICA', 100000.00)
INSERT INTO Curso VALUES ('C02', 'COMUNICACION', 150000.10)
INSERT INTO Curso VALUES ('C03', 'CIENCIAS', 200000.20)
INSERT INTO Curso VALUES ('C04', 'LOGICA', 250000.30)
INSERT INTO Curso VALUES ('C05', 'ETICA', 300000.40)
INSERT INTO Curso VALUES ('C06', 'RELIGION', 350000.50)
INSERT INTO Curso VALUES ('C07', 'FISICA', 400000.60)
INSERT INTO Curso VALUES ('C08', 'QUIMICA', 450000.70)
INSERT INTO Curso VALUES ('C09', 'HISTORIA', 500000.80)
INSERT INTO Curso VALUES ('C10', 'INGLES', 550000.90)

INSERT INTO Matricula VALUES ('M0000001', '2019-08-10', 'A001', 'C01')
INSERT INTO Matricula VALUES ('M0000002', '2020-09-11', 'A001', 'C02')
INSERT INTO Matricula VALUES ('M0000003', '2021-10-12', 'A001', 'C03')
INSERT INTO Matricula VALUES ('M0000004', '2019-11-13', 'A001', 'C04')
INSERT INTO Matricula VALUES ('M0000005', '2020-12-14', 'A002', 'C05')
INSERT INTO Matricula VALUES ('M0000006', '2021-01-15', 'A002', 'C06')
INSERT INTO Matricula VALUES ('M0000007', '2019-02-16', 'A002', 'C07')
INSERT INTO Matricula VALUES ('M0000008', '2020-03-17', 'A002', 'C08')
INSERT INTO Matricula VALUES ('M0000009', '2021-04-18', 'A003', 'C09')
INSERT INTO Matricula VALUES ('M0000010', '2019-05-19', 'A003', 'C10')
INSERT INTO Matricula VALUES ('M0000011', '2020-06-20', 'A003', 'C01')
INSERT INTO Matricula VALUES ('M0000012', '2021-07-21', 'A003', 'C02')
INSERT INTO Matricula VALUES ('M0000013', '2020-08-22', 'A004', 'C03')
INSERT INTO Matricula VALUES ('M0000014', '2019-09-23', 'A004', 'C04')
INSERT INTO Matricula VALUES ('M0000015', '2020-10-24', 'A004', 'C05')
INSERT INTO Matricula VALUES ('M0000016', '2021-11-25', 'A004', 'C06')
INSERT INTO Matricula VALUES ('M0000017', '2021-12-26', 'A005', 'C07')
INSERT INTO Matricula VALUES ('M0000018', '2019-01-27', 'A005', 'C08')
INSERT INTO Matricula VALUES ('M0000019', '2022-02-28', 'A005', 'C09')
INSERT INTO Matricula VALUES ('M0000020', '2019-03-29', 'A005', 'C10')
GO

USE Northwind
GO

CREATE PROC USP_BUSCAR_NOMBREPAIS_CUSTOMERS
@Pais NVARCHAR(15)
AS
	SELECT CustomerID, CompanyName, ContactName, Address, City, Country
	FROM Customers WHERE Country = @Pais
GO

CREATE PROC USP_BUSCAR_RANGOFECHAS_ORDERS
@Ini DATE, @Fin DATE
AS
	SELECT O.OrderID, C.CompanyName, C.ContactName, C.Country, [Employees Name] = (E.LastName + ' ' + E.FirstName), O.OrderDate, O.ShippedDate, O.Freight FROM Orders O 
	JOIN Customers C ON O.CustomerID = C.CustomerID
	JOIN Employees E ON O.EmployeeID = E.EmployeeID
	WHERE ShippedDate BETWEEN @Ini AND @Fin ORDER BY ShippedDate
GO